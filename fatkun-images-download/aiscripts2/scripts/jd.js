function aiparser(e){var t=0;function a(e,t){return(Array(t).join(0)+e).slice(-t)}var n={main_pic:[],video:[],sku:[],detail:[]};var o,c,i=[];if(location.href.match("item.jd.(com|hk)")){chrome.runtime.sendMessage({cmd:"SET_GROUPS",groups:["主图","视频","SKU图片","详情"]});var r=1;document.querySelectorAll("#spec-list img").forEach(function(e){e.src.replace(/\/n\d+\//,"/imgzone/").replace(/s\d+x\d+_jfs/,"jfs").replace(/!cc_50x64.jpg$/,""),i.push({src:e.src.replace(/^(https?:)/,"https:"),group:"主图",groupIndex:0,alt:"主图-"+a(r++,2)})});var s=1;document.querySelectorAll("#choose-attrs img").forEach(function(e){i.push({src:e.src,group:"SKU图片",groupIndex:2,alt:"SKU-"+a(s++,2)})});var d=1,m=document.createElement("script");m.innerText="localStorage.fatkun_pageConfig = JSON.stringify({\n            videoData: window.pageConfig.product.videoData,\n            desc: window.pageConfig.product.desc\n        });",document.body.appendChild(m);var p=JSON.parse(localStorage.fatkun_pageConfig);p.videoData&&p.videoData.playUrl&&(n.video.push(p.videoData.playUrl),new VItem({src:p.videoData.playUrl,group:"视频",groupIndex:1},t++,e,function(t){chrome.runtime.sendMessage({cmd:"ADD_VIDEO",tabId:e.id,item:t})})),chrome.runtime.sendMessage({cmd:"NET",settings:{url:p.desc.replace(/^.*?\/\//,"https://")}},e=>{e.data.content.match(/(http:)?\/\/img\d*?\.360buyimg\.com.*?.(jpg|png|jpeg)/g).forEach(e=>{e.match("^//")&&(e=location.protocol+e),i.push({src:e,group:"详情",groupIndex:3,alt:"详情-"+a(d++,2)})}),chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:i}),_config.recordPageInfo&&(i.forEach(e=>{var t=bigImgParser.parse(e.src);switch(e.group){case"主图":n.main_pic.push(t);break;case"SKU图片":n.sku.push(t);break;case"详情":n.detail.push(t)}}),chrome.runtime.sendMessage({cmd:"SET_PAGE_INFO",pageInfo:"IMAGES JSON DATA:\r\n"+JSON.stringify(n)}))})}else{document.querySelectorAll("img").forEach(function(e){i.push({src:e.src})});for(var u=0;u<i.length;u++)i[u].src.match("blank.gif")||(o=i[u],c=void 0,(c=o.src.replace(/^(https?:)/,"https:")).match("^//")&&(c=location.protocol+c),new ParsedPItem({src:c.replace("!cc_60x76.jpg",""),alt:o.alt,group:o.group,groupIndex:o.groupIndex},t++,e,function(t){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:e.id,item:t})}))}}window.aiparser=aiparser,window.extras={downloadMJX:function(){var e,t,a,n=0,o=!1,c="video";function i(e){return e.match(/^http/)||(e=location.protocol+e),e}function r(t){n++;var o=document.createElement("script");o.src=`https://club.jd.com/discussion/getProductPageImageCommentList.action?productId=${e}&isShadowSku=0&callback=${a}&page=${n}&pageSize=10&_=${Date.now()}`,document.body.appendChild(o)}function s(a){n++;var o=document.createElement("script");o.src=`https://club.jd.com/comment/productPageComments.action?callback=${t}&productId=${e}&score=7&sortType=6&page=${n}&pageSize=10&isShadowSku=0&fold=1`,document.body.appendChild(o)}!function(){e=location.href.match("/(\\d+).html")[1],t=`jsonp${parseInt(1e4*Math.random())}`,a=`jsonpimage${parseInt(1e4*Math.random())}`;var d=document.createElement("script");d.innerText=`\n        window.${t} = function(data){\n            window.postMessage({\n                topic: 'fatkun-tbview',\n                data: data\n            }, '*')\n        };\n        window.${a} = function(data){\n            window.postMessage({\n                topic: 'fatkun-tbview-image',\n                data: data\n            }, '*')\n        };\n    `,document.body.append(d),window.addEventListener("message",function(e){"fatkun-tbview"==e.data.topic?function(e){var t;e.comments&&e.comments.length>0?(e.comments.forEach((e,t)=>{(e=e).images&&chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:e.images.map(t=>({src:i(t.imgUrl),alt:`${e.id}-${t.id}`}))}),e.videos&&chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:e.videos.map(t=>({src:i(t.remark),alt:`${e.id}-${t.id}`,type:"VIDEO"}))})}),o||setTimeout(s.bind(this,n),2e3)):(c="image",r(n=0))}(e.data.data):"fatkun-tbview-image"==e.data.topic&&function(e){e.imgComments&&e.imgComments.imgList&&e.imgComments.imgList.length>0?(chrome.runtime.sendMessage({cmd:"ADD_IMG_LIST",list:e.imgComments.imgList.map(e=>({src:i(e.imageUrl),alt:`${e.commentVo.id}-${e.imageId}`}))}),o||setTimeout(r.bind(this,n),2e3)):chrome.runtime.sendMessage({cmd:"COLLECT_COMPLETED"})}(e.data.data)})}(),chrome.runtime.sendMessage({cmd:"OPEN-OUTPUT",type:"ftk-tb-review"},function(){setTimeout(function(){chrome.runtime.sendMessage({cmd:"SUPPORT_COLLECT_PAUSE"}),s()},2e3)}),chrome.runtime.onMessage.addListener(function(e){"PAUSE_COLLECT"==e.cmd?o=!0:"RESUME_COLLECT"==e.cmd&&(o=!1,"image"==c?r():s())})}};