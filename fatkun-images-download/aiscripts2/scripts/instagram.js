function aiparser(tabInfo){var index=0;function send(e,r){new ParsedPItem(e,r||index++,tabInfo,function(e){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:tabInfo.id,item:e})})}for(var url in document.querySelectorAll("img").forEach(function(e){var r=e.src;if(e.srcset){r=e.srcset.split(",").pop().split(" ")[0];var t=e.closest("a");t?!aiparser_imgs[t.href]&&(aiparser_imgs[t.href]=r):send({src:r})}else send({src:r})}),aiparser_imgs)url.match("instagram.com")?function(index2){fetch(url).then(function(e){return e.text()}).then(function(text){var result=text.match('"display_url":"(.*?)"'),src;result&&eval(`src="${result[1]}"`),send({src:src},index2)})}(index++):send({src:aiparser_imgs[url]})}window.aifuns={"add-download-btn":function(){var e=0;$(document.body).on("mouseenter","article",function(){var r=this;if(!this.querySelector(".fk-download-btn")){var t=document.createElement("button");t.classList.add("fk-download-btn"),t.style.position="relative",t.style.left="-40px";var n=document.createElement("img");n.src=chrome.extension.getURL("img/download.svg"),n.style.width="16px",t.appendChild(n),t.addEventListener("click",function(){var t=r.querySelector("video");if(t)new VItem({src:t.src},e++,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"DOWNLOAD_BY_DRAG",item:e})});else{var n=r.children[1].querySelector("img");new ParsedPItem({src:n.src},e++,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"DOWNLOAD_BY_DRAG",item:e})})}}),r.querySelector("header").appendChild(t)}})}},window.aiparser=aiparser;var aiparser_imgs={};!function(){var e=document.querySelector("main");new MutationObserver(function(e,r){e.forEach(function(e){e.removedNodes.forEach(function(e){e.querySelectorAll("img").forEach(function(e){var r=e.closest("a");r&&!aiparser_imgs[r.href]&&(aiparser_imgs[r.href]=e.srcset?e.srcset.split(",").pop().split(" ")[0]:e.src)})})})}).observe(e,{attributes:!1,childList:!0,subtree:!0,attributeOldValue:!1})}();