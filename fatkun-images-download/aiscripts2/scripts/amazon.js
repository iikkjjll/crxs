function aiparser(tabInfo){if(top==window){var index=0;if(top==window){var script=document.querySelector("#imageBlockVariations_feature_div>script"),imgs=[],skuImgs=[],groups=["SKU"];if(script)try{eval("var obj="+script.innerText.match(/jQuery.parseJSON\('(.*?)'\)/)[1]);var groupIndex=0,skuIndex=0;for(var key in obj.colorImages)groups.push(key),imgs=imgs.concat(obj.colorImages[key].map(function(e,r){return 0==r&&skuImgs.push({alt:`SKU-${PrefixZero(++skuIndex,2)}-${key}`,src:e.hiRes||e.large,group:"SKU",groupIndex:0}),{alt:`${key}-${PrefixZero(r+1,2)}`,src:e.hiRes||e.large,group:key,groupIndex:groupIndex++}}))}catch(e){}if(imgs.length>0){skuImgs.forEach(function(e){send(e)}),imgs.forEach(function(e){send(e)});for(var descImgs=document.querySelectorAll("#aplus img"),i=0;i<descImgs.length;i++)send({src:descImgs[i].dataset.src||descImgs[i].src,alt:`详情Detail-${i+1}`,group:"详情Detail",groupIndex:1e3});groups.push("详情Detail"),chrome.runtime.sendMessage({cmd:"SET_GROUPS",groups:groups})}else{for(var scripts=document.querySelectorAll("script"),i=0;i<scripts.length;i++){var matchrst=scripts[i].innerText.match(/var data = {[\s\S]*'colorImages'[\s\S]*?};/),colorImages=[];if(matchrst){try{eval(matchrst[0]),colorImages=data.colorImages.initial,colorImages.forEach(function(e){imgs.push({src:e.hiRes||e.large})})}catch(e){matchrst=matchrst[0].match("initial.*?(\\[.*}\\])},"),eval(`colorImages=${matchrst[1]}`),colorImages.forEach(function(e){imgs.push({src:e.hiRes||e.large})})}break}}if(imgs.length>0)imgs.forEach(function(e,r){send(e)});else{var imgs=document.querySelectorAll("#altImages img");0==imgs.length&&(imgs=document.querySelectorAll("img")),imgs.forEach(function(e){send({src:e.src})})}}}}function send(e){new ParsedPItem(e,index++,_tabInfo,function(e){chrome.runtime.sendMessage({cmd:"ADD_IMG",tabId:_tabInfo.id,item:e})})}function PrefixZero(e,r){return(Array(r).join(0)+e).slice(-r)}}window.aiparser=aiparser;